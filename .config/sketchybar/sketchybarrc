#!/bin/bash

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# SketchyBar — Tokyo Night Storm
# FelixKratz-inspired config with AeroSpace integration
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

PLUGIN_DIR="$CONFIG_DIR/plugins"
ITEM_DIR="$CONFIG_DIR/items"

source "$CONFIG_DIR/colors.sh"
source "$CONFIG_DIR/icons.sh"

FONT="Hack Nerd Font"
LABEL_FONT="MesloLGS NF"

# ── Bar Appearance ──────────────────────────────────
sketchybar --bar \
  position=top \
  height=40 \
  blur_radius=30 \
  color=$BAR_COLOR \
  border_color=$BAR_BORDER_COLOR \
  border_width=0 \
  shadow=on \
  sticky=on \
  padding_left=10 \
  padding_right=10 \
  topmost=window

# ── Defaults ────────────────────────────────────────
default=(
  padding_left=4
  padding_right=4
  icon.font="$FONT:Bold:14.0"
  label.font="$LABEL_FONT:Semibold:13.0"
  icon.color=$WHITE
  label.color=$WHITE
  icon.padding_left=4
  icon.padding_right=4
  label.padding_left=4
  label.padding_right=4
  background.height=28
  background.corner_radius=8
  popup.background.color=$POPUP_BG
  popup.background.corner_radius=10
  popup.background.border_color=$POPUP_BORDER
  popup.background.border_width=1
  popup.background.shadow.drawing=on
  updates=on
)
sketchybar --default "${default[@]}"

# ── Events ──────────────────────────────────────────
sketchybar --add event aerospace_workspace_change

# ── Left: Workspaces ───────────────────────────────
source "$ITEM_DIR/spaces.sh"

# ── Left: Front App ────────────────────────────────
source "$ITEM_DIR/front_app.sh"

# ── Right: System Items ────────────────────────────
source "$ITEM_DIR/clock.sh"
source "$ITEM_DIR/battery.sh"
source "$ITEM_DIR/volume.sh"
source "$ITEM_DIR/wifi.sh"

# ── Force Initial Update ───────────────────────────
sketchybar --update
